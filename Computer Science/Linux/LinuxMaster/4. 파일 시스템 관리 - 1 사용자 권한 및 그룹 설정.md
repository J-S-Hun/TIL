### 날짜: 2023-01-16 15:24

### 주제:  소유권 변경 관련 내용 숙지 
---
### 메모: 
#### 파일 및 디렉터리의 속성 
- 모든 파일과 디렉터리에는 허가권(Permission)과 소유권(ownership)이 부여된다. 
- ex) -rw-r--r--. 1 root root 45 1월 16 14:22 linux.txt 
	- 파일 유형
		- - 일반 파일
		- c 문자 파일
		- l 심볼릭 링크 파일 
		- b 블록 장치 파일
		- d 장치 파일
		- s 소켓
		- p 파이프 
	- 허가권 
	- 링크 수 
	- 소유자 명
	- 그룹 명 
	- 파일 크기 
	- 마지막으로 변경된 시간 
	- 파일 명 
#### 소유권 관련 명령어
##### chown 
- 파일이나 디렉터리의 사용자 소유권과 그룹 소유권을 변경하는 명령어이다. 
- 파일이나 디렉터리의 사용자 소유권과 그룹 소유권을 한 번에 변경할 수 있다. 
	- -chown의 구분자: .(마침표), :(클론)
	- chown \[옵션] \[사용자 명].\[그룹 명] \[파일/디렉터리 명]
- 옵션
	- -c 소유권 변경 정보 출력
	- -f 오류 메시지 출력 안함 
	- **-R 하위 디렉터리를 포함한 모든 파일과 디렉터리의 사용자 소유권 변경**
##### chgrp 
- 파일이나 디렉터리의 그룹 소유권을 변경하는 명령어이다. 
- 옵션
	- -R 하위 디렉터리를 포함한 모든 파일과 디렉터리의 그룹 소유권을 변경  
	- -c 변경된 파일만 자세히 출력 
	- -f 변경되지 않은 파일에 대해선 오류 메시지를 출력하지 않음 
	- -v 작업상태를 자세히 출력
#### 허가권 관련 명령어
##### 개요 
- 파일이나 디렉터리의 허가권을 변경 하는 명령어이다. 
- 허가권은 read, write, execute로 구분할 수 있다. 
###### 사용 모드
|                   | 사용자권한 | 그룹권한 | 제3자 권한 |
| ----------------- | ---------- | -------- | ---------- |
| 기호 모드(알파벳) | r w x      | r w x    | r w x      |
| 숫자 모드(8진수)  | 4 2 1      | 4 2 1    | 4 2 1      |
###### 사용 기호
|      | 사용자                        | 권한                                | 연산자         |
| ---- | ----------------------------- | ----------------------------------- | -------------- |
| 기호 | u g o a                       | + - =                               | r w x          |
| 의미 | 사용자 그룹 제3자 모든 사용자 | 허가권 부여 허가권 제거 허가권 지정 | 읽기 쓰기 실행 | 
###### 권한
|      | 일반 파일         | 디렉터리                                   | 특수파일               |
| ---- | ----------------- | ------------------------------------------ | ---------------------- |
| 읽기 | 내용 읽기         | **디렉터리 안의 파일/디렉터리 목록 출력**      | 'read( )' 함수로 읽기  |
| 쓰기 | 내용 수정 및 제거 | **디렉터리 안의 파일/디렉터리 생성,수정,제거** | 'write( )' 함수로 읽기 |
| 실행 | 내용 실행         | **디렉터리 안으로 진입**                       | -                      | 
##### chmod 
- 파일이나 디렉터리의 허가권을 변경하는 명령어이다.
- 옵션
	- -c 소유권 변경 정보 출력 
	- -R 하위 디렉터리를 포함한 모든 파일과 디렉터리의 사용자 소유권 변경 
	- -v 각 파일의 모드 변경 상태 출력 
- ex) chmod 755 linux.txt
- ex) chmod u-x, g+w, o-x linux.txt
- ex) chmod a=r gnu
##### umask
- 새로 생성되는 파일이나 디렉터리의 기본 허가권을 지정하는 명령어이다. 
- *'umask'값이 022인 경우 Default 파일 권한은 644로, 디렉터리 권한은 755로 생성한다.*
- 옵션
	- -S 'umask' 값을 기호로 출력 
- 새로 만들어질 파일과 디렉터리에 대해 그룹이나 전체에 쓰기 권한이 부여되는 것을 방지하기 위해 umask 값을 '222'로 설정한다.
#### 특수 허가권 (복습 필요)
- 프로세스가 실행되는 동안 *해당 파일을 실행한 사용자가 아닌 해당 파일을 소유한 사용자의 권한으로 실행하도록 만드는 허가권이다.*
##### 기능 
- **낮은 수준의 사용자가 높은 수준의 자원에 접근 시 접근 제한으로 인해 발생하는 문제를 해결하기 위해 사용한다.**
- 프로세스를 실행하는 동안만 소유자나 그룹 권한으로 실행한다.
- SetUID, SetGID 비트: s, S Sticky 비트: t, T
	- **소문자: 해당 파일에 실행 권한이 부여되어 있을 경우이며, 정상적인 권한으로 실행함** 
	- **대문자: 해당 파일에 실행 권한이 부여되어 있지 않을 경우이며, 정상적인 권한으로 실행되지 않음**
##### 허가권 
|        | 기호 | 절대값 | 설명                                                                                                                                                              |
| ------ | ---- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| SetUID | s    | 4000   | 파일의 소유자 실행 권한에 UID 설정                                                                                                                                |
| -      |      |        | **SetUID가 설정된 파일 실행 시, 특정 작업 수행을 위하여 일시적으로 파일 소유자의 권한을 부여하는 비트**                                                           |
| SetGID | s    | 2000   | 파일의 그룹 실행 권한에 GID 설정                                                                                                                                  |
| -      |      |        | **SetGID가 설정된 파일 실행 시, 특정 작업 수행을 위하여 일시적으로 파일 소유자 그룹의 권한을 부여하는 비트**                                                      |
| Sticky | t    | 1000   | 파일의 제3자 실행 권한에 Sticky Bit 설정                                                                                                                          |
| -      |      |        | **Sticky Bit가 설정된 디렉터리 안의 파일에 모든 사용자에게 쓰기 권한이 부여되어 있을 경우에도 파일의 소유자나 'root' 사용자가 아니면 해당 파일을 삭제할 수 없음** |
| -      |      |        | 누구나 파일을 생성, 수정은 가능                                                                                                                                   |
#### 디스크 쿼터 
- **파일 시스템별 사용자나 그룹의 사용량을 제한할 경우에 사용한다.** 
##### 기능 
- *block이나 I-Node의 개수를 제한한다.* 
- 사용자별, 파일 시스템별로 작동한다. 
##### 사용자별 쿼터 설정 
| filesystem | 사용자별 쿼터 설정 파일 시스템             | -                                                |
| ---------- | ------------------------------------------ | ------------------------------------------------ |
| blocks     | *현재 사용자가 사용한 블록(단위 : KB)*     | -                                                |
| -          | soft                                       | *사용자가 사용할 수 있는 최대 용량(초과 가능*)   |
| -          | -                                          | 유예 기간 동안 초과 경고 메시지                  |
| -          | hard                                       | *사용자가 사용할 수 있는 최대 용량(초과 불가능)* |
| inodes     | *현재 사용자가 사용한 파일 수(단위: 개수)* | -                                                |
| -          | soft                                       | *사용자가 사용할 수 있는 최대 파일 수(초과 가능)*  |
| -          | -                                          | 유예 기간 동안 초과 경고 메시지                  |
| -          | hard                                       | *사용자가 사용할 수 있는 최대 파일 수(초과 불가능)*                                                 |
##### 쿼터 관련 명령어 
###### quotaon
- 쿼터를 활성화하는 명령어이다. 
- 옵션
	- a 모든 파일 시스템에 대해 쿼터 적용
	- -g  그룹 쿼터 적용
	- -u 사용자 쿼터 적용
	- -v 쿼터 적용된 파일 시스템에 대한 상세한 정보 출력 
###### quotaoff
- 파일 시스템에 적용된 쿼터의 사용을 중지하는 명령어이다. 
- 옵션
	- -a 모든 파일 시스템에 대해 쿼터 중지
	- -g  그룹 쿼터 중지
	- -u 사용자 쿼터 중지
	- -v 쿼터 중지된 파일 시스템에 대해 상세한 정보 출력 
###### quotacheck
- 모든 파일 시스템을 점검하고, 쿼터 설정 및 기록 파일 갱신하는 명령어이다. 
- 'quota.user', 'quota.group', 'aquota.user', 'aquota.group'의 파일을 점검하고 갱신
- 옵션
	- -a 모든 파일 시스템에 대해 점검 및 기록 갱신
	- -g 그룹 기록 갱신
	- -m 파일 시스템을 읽기 전용으로 다시 마운트하지 않음
	- -u 사용자 기록 갱신
	- -v 실행 결과를 상세히 출력 
###### edquota
- 사용자와 그룹에 대해 쿼터를 설정하고 변경하는 명령어이다. 
- 옵션
	- -g 그룹 쿼터 설정 및 변경 
	- -t 유예 기간 확인 및 변경
	- -u 사용자 쿼터 설정 및 변경 
	- -p 기존 사용자의 할당량 설정을 다른 사용자에게 그대로 복사 
###### setquota 
- 터미널에서 직접 사용자나 그룹에 쿼터를 적용하는 명령어이다. 
- 옵션 
	- -a 해당 파일 시스템 모두 설정 
	- -g 그룹 쿼터 설정 
	- -u 사용자 쿼터 설정 
###### repquota 
- 터미널에서 직접 사용자나 그룹에 적용된 쿼터(디스크 사용량, 적용 내용)를 요약하여 출력하는 명령어이다.
- 옵션 
	- a */etc/mtab를 참조하여 쿼터 설정 내용 출력* 
	- g 
	- u 
###### xfs_quota 
- xfs 파일 시스템에서 quota를 설정하기 위해 사용하는 명령어이다. 
	- *xfs 파일 시스템: 고성능 64비트 저널링 파일 시스템, Cent OS 7버전부터 기본 지원되는 파일 시스템* 
- 사용자 그룹에 용량 제한을 하는 usrquota, grpquota가 있으며, 특정 폴더에 대해 용량 제한을 할 수 있는 pquota(project quota)가 있다. 
- 전문가 모드와 일반 모드가 있으며, 일반적으로 전문가 모드로 설정하게 된다. 
###### 디스크 쿼터를 설정하는 명령어의 순서
1. **quotacheck**
2. **edquota**
3. **quotaon**
4. **repquota**
### 출처(참고문헌) 
- 한 권으로 끝내기 리눅스 마스터 2급 

### 연결문서 
- [[4. 파일 시스템 관리 - 2 파일 시스템 관리 유틸리티]]

### Tag
- #CS/Linux 
- #LinuxMaster 