 ### 날짜: 2023-01-16 15:25

### 주제: 파일 시스템 이론 숙지 필요 
---
### 메모: 
#### 파일 시스템 구조 
- **파일 시스템은 시스템에서 파일이나 자료를 쉽게 검색하고, 접근, 유지, 관리하기 위한 조직체계이다.** 즉, 저장매체에는 많은 파일이 있으므로, 이러한 파일을 관리하는 방법을 의미한다. 
- 계층적 구조를 가지며, 디스크 파티션별로 하나씩 존재하고, 하드디스크나 CD-ROM과 같은 물리적 저장소를 관리한다. 
![[스크린샷 2023-01-21 11.58.19.png|500]]
- Super Block 
	- *파일 시스템 관련 정보 저장* 
	- 블록의 개수, 블록 그룹 개수, 아이노드 개수 저장
- Group Description Table 
	- *모든 블록 그룹 관련 정보 저장* 
		- *블록 비트맵과 아이노드 비트맵의 블록 번호* 
		- 첫 번째 아이노드 테이블 블록의 블록 번호 
		- *빈 블록 수, 빈 디렉터리 수, 아이노드 수* 
- Block/I-Node Bitmap
	- *블록/아이노드 사용 현황을 Bit를 활용하여 Map 형태로 나타낸 것* 
- I-Node Table
	- *아이노드와 관련된 정보를 테이블 형태로 나타낸 것* 
##### 종류 
- **ext**
	- 리눅스 초기 파일 시스템으로, 호환성이 없음 
	- 파일 접근에 대한 타임 스탬프, 아이노드 수정 불가 
- **ext2**
	- 부트 섹터(Boot Sector)와 블록 그룹(Block Group)으로 구성(Block Group은 파일)
	- *파일 시스템 테이블을 정의하기 위하여 시스템 내의 각 파일을 아이노드 자료구조로 표현하며, 모든 정보를 'Super Block'과 'Group Descriptor Table'에 저장* 
	- *파일에 들어 있는 데이터는 데이터 블록에 저장되며, 데이터 블록의 크기는 같음* 
	- 'ext2' 파일 시스템의 크기는 'mke2fs' 명령을 통하여 파일 시스템이 만들어질 때 결정 
	- 파일 시스템이 손상되었을 때, 'fsck(File System Check)'를 이용하여 데이터를 복원할 수 있으나, 캐시에 저장된 데이터를 하드디스크에 저장하는 동안 시스템의 다운 등의 문제 발생 시 파일 시스템이 손상됨 
- **ext3** 
	- 커널 2.4 버전부터 지원 
	- 사용자가 직접 데이터 보호 유형과 보호 수준 결정 가능 
	- *'etx2' 파일 시스템의 검사 시 또는 복구 시 시간이 오래 걸리거나 시스템을 사용하지 못하는 단점을 보완하기 위하여 저널링 기능 추가* 
		- 데이터의 신뢰성과 작업 능률을 향상시킬 수 있음 
		- *저널링: 스토리지에 데이터를 저장하기 전에 Journal 영역에 데이터의 변경 이력을 저장하고, 스토리지에 데이터 변경 내역을 저장하는 활동*
- **ext4**
	- 64비트 기억공간의 제한을 없애고, ext3 파일 시스템보다 성능을 향상시켰으며, 호환성이 있는 확장 버전 
	- 1EB(Exabyte) 이상의 볼륨과 16TB 이상의 파일 지원 
	- 지연된 할당(Allocate on Flush) 파일 시스템 기능 지원 
		- *Allocate on Flush: 데이터가 디스크에 쓰여지기도 전에 블록을 할당하는 다른 파일 시스템과 다르게, 데이터가 디스크에 쓰여지기 전까지 블록 할당을 지연시킨다.*
	- *실제 파일 크기에 기반하여 블록 할당을 결정하고, 향상된 블록 할당이 가능하므로 단편화를 줄이고, 성능을 향상시킴*
##### 기타 파일 시스템
###### 저널링 파일 시스템 
- JFS(Journaling File System)
	- IBM사의 독자적인 저널링 파일 시스템
- XFS(Extended FIle System) 
	- 높은 확장성과 처리량
- ReiserFS
	- 가장 안정적인 저널링 파일 시스템 
	- 모든 파일을 B-Tree에 저장하고, 간결한 디렉터리 지원 
###### 네트워크 파일 시스템 
- SMB(Server Message Block)
	- 'SAMBA' 파일 시스템으로 사용 
	- 리눅스와 윈도 운영체제 간 자료 및 하드웨어 공유 프로토콜 
- CIFS(Common Internet File System) 
	- SMB 확장 파일 시스템 
	- 네트워크에서 자료를 주고받게 해주는 프로토콜 
- NFS(Network FIle System)
	- 썬 마이크로시스템이 개발한 네트워크 공유 프로토콜 
	- 서로 다른 운영체제 간 파일/디렉터리 공유 가능 
###### 기타 파일 시스템 
- ISO9660 
	- CD-ROM 표준 파일 시스템 
- UDF 
	- 공학 저장 기술협회(OSTA)에 의해 개발 
	- 광학 매체용 표준 파일 시스템 
	- 대부분 DVD에서 사용 
- HPFS 
		- MS사와 IBM이 공동 개발 
		- OS/2 운영체제용 파일 시스템
#### 파일 시스템 관련 명령어 
##### fdisk
- 파티션을 생성, 수정, 제거 및 파일 시스템의 유형을 지정하는 명령어이다. 
- 옵션
	- l 현재 파일 시스템과 파티션 정보 출력
	- s 지정된 파일 시스템의 크기를 블록 단위로 출력 
	- m 모든 메뉴 목록을 출력하낟
	- n 새로운 파티션 생성한다
	- t 파티션의 속성을 변경한다
##### mkfs 
- 파일 시스템을 생성하는 명령어이다. 
- 옵션 
	- c 파일 시스템 불량 블록 검사 
	- t 파일 시스템의 유형 지정
	- v 작업 과정 출력
##### mke2fs 
- 'mkfs' 명령어의 확장 버전으로 파일 시스템을 생성하는 명령어이다. 
- 옵션
	- b 블록 크기 지정
	- c 불량 블록 검사 
	- f 플래그먼트 크기 지정
	- i 아이노드 크기 지정
	- j 'ext3' 파일 시스템 이상에서 저널링 기술 적용하여 생성
	- S 슈퍼 블록 복구 시사용
	- t 파일 시스템 유형 지정 
##### mkfs.xfs
- xfs 파일 시스템을 생성하는 명령어이다. 
##### fsck 
- 파일 시스템의 무결성 점검과 오류를 복구하는 명령어이다. 
- 'lost+found' 디렉터리에 저장된 파일을 복구하며, 복구가 완료되면 파일은 제거된다. 
##### e2fsck
- 'fsck' 명령어의 확장 버전이다. 
- 파일 시스템의 무결성 점검과 오류를 복구하는 명령어이다. 
##### xfs_repair 
- xfs 파일 시스템을 검사 및 복구하는 명령어이다. 
##### mount, umount
- 특정 장치와 디렉터리를 연결하는 명령어이다. 
- 기본적으로 주변 장치는 자동으로 마운트되지 않으므로, 시스템 부팅 후 수동으로 마운트하여 사용하고, 사용 완료 후에는 언마운트하여 연결을 종료해야 한다. 
- **하드웨어장치를 리눅스에서 사용하기 위해 인식시켜주는 명령어**
- 옵션
	- a 'fstab' 파일에 있는 모든 파일 시스템 마운트 
	- f 실제로 마운트하지 않고, 마운트를 할 수 있는지 확인 
	- n /etc/mtab 파일에 쓰기 작업을 하지 않고 마운트
	- o 추가 옵션
	- r 읽기 전용 마운트
	- t 파일 시스템 유형 지정
	- w 읽기/쓰기 모드로 마운트
- ex) 파일 시스템 유형이 'ext4'인 '/dev/sdb1'을 '/mnt' 디렉터리에 읽기 전용으로 마운트 
	- mount -t ext4 -o ro /dev/sdb1 /mnt 
##### eject 
- DVD나 CD-ROM 등의 미디어 장치를 해제하고, 꺼내는 명령어이다. 
##### df 
- 시스템에 마운트된 하드디스크의 사용량과 남은 용량을 확인하는 명령어이다. 
- h: 사용자가 읽기 쉽게 사용량을 출력(1KB, 100M, 10G)
- k: 'KB' 단위로 출력 
- -hT: 사용자가 읽기 쉽게, 파일 시스템 유형 정보를 출력 
- -i: I-Node의 남은 공간, 사용 공간, 사용량을 출력
#### 파일 시스템 관련 파일 
##### /etc/fstab
- **파일 시스템 관련 설정 정보를 저장하고 있는 파일이다.** 
- **시스템 부팅 시 파일 시스템을 자동으로 마운트 하고자 할 때, 이 파일을 설정하면 된다.** 
#### 기출문제 정리
3. 리눅스에서 사용하는 파일시스템 유형
	- ext, vfat, ntfs
	- smb: 윈도에서 파일이나 디렉터리 및 주변 장치들을 공유하는데 사용되는 메시지 형식 
4. 명령어 
	- UUID: Universally Unique Identifier의 약어로, 정보 식별을 위하여 사용되는 식별자이다. 128-bit 숫자로 이루어져 있다.
	- e2label: 디스크의 레이블(label)을 변경하는 명령어
	- blkid: 시스템의 모든 파티션에 대한 'UUID' 값을 출력한다. 
	- tune2fs: 리눅스 파일 시스템의 변경 가능한 파라미터값을 설정하는 명령어
13. # chmod o=r lin.txt 
	- 'lin.txt' 파일의 모든 권한을 제거하고, 읽기(r) 권한만을 부여(=r) 한다.
	- 기존 -rw-rw-rw -> -rw-rw-r-- 
28. 설정된 'umask'의 값이 '0022'일 때 생성되는 파일의 허가권 값은?
	- -rw-r--r--
	- 파일의 허가권(0666) - umask(0022) = 0644
29. umask -S: umask 값을 기호로 출력
37. 리눅스 시스템에서 기본적으로 'SetUID'가 설정된 파일은 passwd 이다.
41. SetUID, SetGID (보통 실행 파일에 사용) vs Sticky Bit (특정 디렉터리에 사용)
42. 'Sticky Bit'가 설정된 디렉터리는 /tmp 이다. 
	 - /tmp: 임시 디렉터리로, 기본값으로 누구나 읽고, 쓰고, 실행하도록 설정되어 있다.
	- /home: 사용자 계정의 홈 디렉터리가 위치하는 디렉터리 
	- /var: 시스템 운영 중 데이터가 변경되는 파일들이 위치하는 디렉터리 
	- /etc: 시스템 관리 시 필요한 설정 파일들이 위치하는 디렉터리
44. 특수 권한인 Set-Bit가 설정된 파일
	- /bin/su
	- /bin/mount
	- /usr/bin/passwd
45. /dev/null
	- 널 장치, 비트 버킷, 블랙홀, 리눅스 null 장치 파일로 주로 불필요한 출력 스트림을 버리는 곳으로 사용한다. 
46. 특수 허가권: SetUID(4), SetGID(2), Sticky Bit(1)
	- chmod 3770 /project
	- /project 디렉터리에는 'SetGID', 'Sticky Bit'가 설정되어 있다. 
47. 파일의 제거 권한은 디렉터리 권한에 의해 부여된다.
48. 사용 중인 시스템에서 새 하드디스크를 추가하여 사용하기 위한 과정은 
	- 파티션 생성 
	- 파일 시스템 생성 
	- 마운트
49. 명령어
	- du: 디렉터리별로 사용량을 확인할 때 사용하는 명령어
	- df: 파일 시스템별로 사용량을 확인할 때 사용하는 명령어, 디스크의 사용 가능한 용량을 확인할 때 사용
	- free: 메모리 사용량을 확인하는 명령어
50. /dev/hdb1 를 저널링 파일 시스템으로 만들고,I-node의 크기를 1MB로 저장한다.
	- mke2fs -j -T largefile /dev/hdb1
51. 명령어
	- fsck: 시스템을 점검하고자 할 때 사용되는 명령어이고 실제로 이 명령어는 특정 파일 시스템을 점검하도록 설계된 일련의 명령에 대한 선행, 점검하고자 하는 해당 장치를 언마운트 한 상태에서 사용해야 한다.
	- ifconfig: 인터페이스 정보를 출력
	- netstat: 현재 시스템의 네트워크 상태를 출력
	- nslookup: DNS 주소 정보를 출력
52. 'fsck' 명령어 실행 시 '-t' 옵션을 사용하지 않았을 경우 파일 시스템의 유형을 참조하는 곳
	- /etc/fstab
74. 파일 시스템 
	- nfs: 공유된 원격 호스트의 파일을 로컬에서 사용할 수 있도록 개발된 파일 시스템
	- cifs: 네트워크를 위한 'SMB' 파일 공유 프로토콜의 확장된 버전이며, 윈도와 유닉스 환경을 동시에 지원하는 인터넷의 표준 프로토콜이다.
	- ntfs: 윈도 NT 운영체계가 하드디스크 상에 파일들을 저장하고 검색하는데 사용하는 파일 시스템
	- udf: 광디스크의 파일 저장을 위한 파일 시스템의 포맷 규격, DVD 파일 시스템으로 대부분의 배포판 리눅스에서 'iso9660'으로 지정해도 마운트 할 수 있는 파일 시스템
77. 파일시스템 mount -o 명령어
	- rw: 읽기, 쓰기 모드로 마운트
	- loop: CD-ROM의 이미지 파일(iso)을 마운트
	- remount: 마운트된 부분을 시스템을 재시작하지 않고, 다시 마운트
	- ro: Read-Only
80. 파일 시스템 
	- smb: Server Message Block의 약어로, 윈도에서 파일이나 디렉터리 및 주변 장치들을 공유하는데 사용 되는 메시지 형식 
	- samba: 주로 리눅스와 윈도 서버간의 자원 공유를 위한 용도로 사용하는 서버 
		- smbfs: samba file system
		- cifs: 삼바 파일 시스템을 마운트 할 때 지정하는 유형 
	- nfs: 공유된 원격 호스트의 파일을 로컬에서 사용할 수 있도록 개발된 파일 시스템 
91. /etc/fstab을 구성하고 있는 필드
	- 장치명, 마운트 포인트, 파일 시스템 종류, defaults, 덤프 유무, 파일 시스템 검사 유무

### 출처(참고문헌) 
- 한 권으로 끝내기 리눅스 마스터 2급 

### 연결문서 
- [[4. 파일 시스템 관리 - 1) 사용자 권한 및 그룹 설정]]
- [[1. I-Node란?]]

### Tag
- #CS/Linux 
- #LinuxMaster 